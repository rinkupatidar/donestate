(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8096],{74399:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var s=r(85893),n=r(86889),a=r.n(n),i=r(57402);function c(e){var t=e.disableSection,r=e.className;return(0,s.jsx)("div",{className:"".concat(t?void 0:"section"," ").concat(a().loading_section," ").concat(r),children:(0,s.jsx)(i.Z,{})})}},2168:function(e,t,r){"use strict";var s=r(47568),n=r(26042),a=r(69396),i=r(70655),c=r(85893),o=r(85945),l=r(48228),u=r(41107),h=r(18419),d=r(85998),f=r(77854),p=r(1438),g=r(87536),m=r(89583),v=r(53159),_=r(11163),x=r(67294),j=r(5121),N=function(e){var t=e.close,r=e.config,N=e.symbol,C=e.customKey,b=e.rangeselect,y=e.chart_format,S=(e.B_S_Item,e.handleDataFromFinance);e.onSuccessCallback;var w=(0,_.useRouter)(),Z=(0,g.cI)(),P=Z.register,I=Z.handleSubmit,E=Z.formState.errors,A=(0,o.NL)(),O=(0,l.D)(v.C2),T=(0,x.useState)({});T[0],T[1];var k=function(e){console.log(e,"crete"),S(e)},z=I(function(e){var n,a,c,o=e.title;return(null==r?void 0:null===(a=r.chart_items)||void 0===a?void 0:a.length)===1?(c={chart_items:[{displayValue:N,type:"",controlType:"symbol"},{item_id:"bs.as.reported.position_1",item_name:"Cash & Equivalents",item_group:"BALANCE_SHEET",item_type:"FINANCIAL",chart_item_symbol:N,item_component_type:"BAR",item_additional_info:{},item_order:1}],chart_range:r.rangedata,chart_format:y,toDate:r.toDate,fromDate:r.fromDate,chart_type:C}).chart_data_type=b:((c=r).chart_range=r.rangedata,c.chart_format=y,delete c.rangedata,c.chart_data_type=b),O.mutate({title:o,chart_config:"FINANCIAL"===C?c:r,symbol:N,chart_type:"FINANCIAL"===C?"FINANCIAL":"ECONOMICS"===C?"ECONOMICS":"STOCK"},{onSuccess:(n=(0,s.Z)(function(e){var r,s,n,a,c,l,u,h,d,f,g,m,_,x,b;return(0,i.__generator)(this,function(e){switch(e.label){case 0:if(A.invalidateQueries(p.Ed),t(),(r=new URL(location.href)).searchParams.set("titles",o),w.push(r,void 0,{scroll:!1}),"FINANCIAL"!==C)return[3,9];n={X_AUTH_TOKEN:localStorage.getItem("token"),"Content-Type":"application/json"},e.label=1;case 1:return e.trys.push([1,7,,8]),[4,j.Z.get("https://api.donestat.co/rest/v1/getChartTitles?symbol=".concat(N,"&chart_type=").concat(C,"&page=1)"),{headers:n})];case 2:if(200!==(a=e.sent()).status)return[3,6];console.log("First API response:",a),c=a.data[0][0],e.label=3;case 3:return e.trys.push([3,5,,6]),[4,(0,v.B0)({chart_id:c})];case 4:return k(e.sent()),[3,6];case 5:return u=e.sent(),console.error("Error calling second API:",u),[3,6];case 6:return[3,8];case 7:return h=e.sent(),console.error("Error calling another API:",h),[3,8];case 8:return[3,17];case 9:if("ECONOMICS"!==C)return[3,17];f={X_AUTH_TOKEN:localStorage.getItem("token"),"Content-Type":"application/json"},e.label=10;case 10:return e.trys.push([10,16,,17]),[4,j.Z.get("https://api.donestat.co/rest/v1/getChartTitles?chart_type=".concat(C,"&page=1)"),{headers:f})];case 11:if(200!==(g=e.sent()).status)return[3,15];console.log("First API response:",g),m=g.data[0][0],e.label=12;case 12:return e.trys.push([12,14,,15]),[4,(0,v.B0)({chart_id:m})];case 13:return k(e.sent()),[3,15];case 14:return x=e.sent(),console.error("Error calling second API:",x),[3,15];case 15:return[3,17];case 16:return b=e.sent(),console.error("Error calling another API:",b),[3,17];case 17:return[2]}})}),function(e){return n.apply(this,arguments)})})});return(0,c.jsxs)(f.Z,{close:t,children:[(0,c.jsx)("p",{className:"is-size-5 mb-3",children:"Add a title to your chart"}),(0,c.jsxs)("form",{onSubmit:z,children:[(0,c.jsx)(d.Z,(0,a.Z)((0,n.Z)({},P("title",{required:"Title is required"})),{cSize:"small",label:"Chart Title",error:E.title})),(0,c.jsx)("div",{className:"is-flex is-justify-content-flex-end ",children:(0,c.jsxs)(u.Z,{className:"is-warning mt-3",size:"small",type:"submit",children:[(0,c.jsx)(h.Z,{children:(0,c.jsx)(m.wEH,{})}),(0,c.jsx)("span",{children:"Save"})]})})]})]})};t.Z=N},88096:function(e,t,r){"use strict";r.r(t),r.d(t,{SavedChart:function(){return I}});var s=r(47568),n=r(26042),a=r(69396),i=r(70655),c=r(85893),o=r(48228),l=r(36492),u=r(59403),h=r(41107),d=r(18419),f=r(85998),p=r(73798),g=r(77854),m=r(1438),v=r(65820),_=r(67294),x=r(73935),j=r(47516),N=r(89583),C=r(53159),b=r(2168),y=r(25258),S=r.n(y),w=r(11163),Z=r(31780),P=r(74399),I=function(e){var t,r,y,I,E=e.config,A=e.symbol,O=e.loadChartConfig,T=e.parentConfig,k=(0,_.useState)(""),z=k[0],F=k[1],L=(0,_.useState)(!1),M=L[0],R=L[1],D=(0,_.useState)(!1),K=D[0],B=D[1],H=(0,o.D)(C.k0),q=(0,_.useState)(),J=q[0],U=q[1],G=(0,_.useState)(),Q=G[0],V=G[1],X=(0,w.useRouter)(),W=(0,l.a)(m.Ed,function(){return(0,C.ch)({symbol:A,page:1,chart_type:"STOCK"})},{enabled:!T}),Y=(r=(0,s.Z)(function(e){var t;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,(0,C.JI)(e)];case 1:return V(t=r.sent()),O(t.chart_config),[2]}})}),function(e){return r.apply(this,arguments)}),$=(y=(0,s.Z)(function(e){var t,r,s,n;return(0,i.__generator)(this,function(a){switch(a.label){case 0:if(t=X.query.titles,!((r=e.filter(function(e){return e[2]===t})).length>0))return[3,2];return s=r[0][0],[4,(0,C.JI)(s)];case 1:return V(n=a.sent()),O(n.chart_config),t="",[3,3];case 2:console.log("No item found with the specified value"),a.label=3;case 3:return[2]}})}),function(e){return y.apply(this,arguments)});(0,_.useEffect)(function(){W.data&&$(W.data)},[X,W.data]);var ee,et=(I=(0,s.Z)(function(){var e;return(0,i.__generator)(this,function(t){switch(t.label){case 0:return R(!0),e=T||Q,[4,(0,C.Ll)((0,a.Z)((0,n.Z)({},e),{chart_config:E}))];case 1:return t.sent(),R(!1),[2]}})}),function(){return I.apply(this,arguments)}),er=(ee=(0,s.Z)(function(e){var t;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,(0,C.JI)(e[0])];case 1:return(t=r.sent()).delete_warn_message?U(t):H.mutate(e[0],{onSuccess:function(){return W.refetch()}}),[2]}})}),function(e){return ee.apply(this,arguments)}),es=W.data,en=(0,u.N)(["search-chart-titles",z,"STOCK"],function(e){var t=e.pageParam;return(0,C.tB)({search_text:z,chart_type:"STOCK",page:void 0===t?1:t})},{enabled:!!z,getNextPageParam:function(e,t){return t.length+1}}),ea=en.data,ei=en.fetchNextPage;en.isFetching;var ec=[];null==ea||null===(t=ea.pages)||void 0===t||t.forEach(function(e){null==e||e.forEach(function(e){var t;(null===(t=e[2])||void 0===t?void 0:t.toLowerCase().includes(z.toLowerCase()))&&ec.push(e)})});var eo=z?ec:es,el=function(e){F(e.target.value.toLowerCase())};return(0,c.jsxs)("div",{className:"v_data_section fill-height is-relative",children:[(0,c.jsxs)(v.M,{children:[J&&(0,c.jsx)(g.Z,{width:"30vw",close:function(){return U(void 0)},children:(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"is-size-6 has-tw-bold",children:J.delete_warn_message}),(0,c.jsxs)("div",{className:"buttons is-centered mt-5 are-small",children:[(0,c.jsx)(h.Z,{onClick:function(){return U(void 0)},children:"Cancel"}),(0,c.jsx)(h.Z,{className:"is-danger",onClick:function(){H.mutate(J.chart_id,{onSuccess:function(){return W.refetch()}}),U(void 0)},children:"Delete Chart"})]})]})}),K&&(0,c.jsx)(b.Z,{close:function(){return B(!1)},config:E,symbol:A},"STOCK"),M&&(0,c.jsx)(p.Z,{})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"is-size-7 has-text-grey mb-2",children:"Saved Charts"}),(0,c.jsx)(f.Z,{onChange:el,value:z,placeholder:"Search",cSize:"small",icon:(0,c.jsx)(d.Z,{children:(0,c.jsx)(N.U41,{})})})]}),(0,c.jsx)("div",{className:S().list_wrapper,children:(0,c.jsxs)("div",{className:S().list,children:[(null==eo?void 0:eo.length)===0&&(0,c.jsx)("p",{className:"is-size-7 has-tw-bold is-sizei-7 has-text-centered has-text-gray mt-6",children:"No charts found"}),(0,c.jsxs)("div",{children:[null==eo?void 0:eo.map(function(e){return(0,c.jsxs)("div",{"data-selected":(null==Q?void 0:Q.chart_id)===e[0],onClick:function(){return Y(e[0])},className:S().item,children:[(0,c.jsx)("span",{children:e[2]}),(0,c.jsx)("div",{onClick:function(t){t.stopPropagation(),er(e)},children:(0,c.jsx)(d.Z,{className:"has-text-grey",children:(0,c.jsx)(N.aHS,{})})})]},e[0])}),z&&(0,c.jsx)(Z.E.div,{onViewportEnter:function(){ei()},children:(0,c.jsx)(P.Z,{disableSection:!0,className:"mt-3"})})]})]})}),(0,x.createPortal)((0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(h.Z,{onClick:function(){return B(!0)},size:"small",className:"is-warning is-outlined is-flex-grow-1",children:[(0,c.jsx)(d.Z,{children:(0,c.jsx)(N.wEH,{})}),(0,c.jsx)("span",{children:"Create"})]}),(0,c.jsxs)(h.Z,{disabled:T?!T:!Q,size:"small",className:"is-warning is-outlined is-flex-grow-1",onClick:et,children:[(0,c.jsx)(d.Z,{children:(0,c.jsx)(j.jC8,{})}),(0,c.jsx)("span",{children:"Save "})]})]}),document.getElementById(m.Nr))]})};t.default=I},25258:function(e){e.exports={list_wrapper:"SavedCharts_list_wrapper__HaSw7",list:"SavedCharts_list__JzRzu",item:"SavedCharts_item__af7c_"}},59403:function(e,t,r){"use strict";r.d(t,{N:function(){return o}});var s=r(32161),n=r(52924),a=r(9499);class i extends n.z{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:(0,a.Gm)()},t)}getOptimisticResult(e){return e.behavior=(0,a.Gm)(),super.getOptimisticResult(e)}fetchNextPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"forward",pageParam:e}}})}fetchPreviousPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"backward",pageParam:e}}})}createResult(e,t){var r,s,n,i,c,o;let{state:l}=e,u=super.createResult(e,t),{isFetching:h,isRefetching:d}=u,f=h&&(null==(r=l.fetchMeta)?void 0:null==(s=r.fetchMore)?void 0:s.direction)==="forward",p=h&&(null==(n=l.fetchMeta)?void 0:null==(i=n.fetchMore)?void 0:i.direction)==="backward";return{...u,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,a.Qy)(t,null==(c=l.data)?void 0:c.pages),hasPreviousPage:(0,a.ZF)(t,null==(o=l.data)?void 0:o.pages),isFetchingNextPage:f,isFetchingPreviousPage:p,isRefetching:d&&!f&&!p}}}var c=r(67187);function o(e,t,r){let n=(0,s._v)(e,t,r);return(0,c.r)(n,i)}}}]);